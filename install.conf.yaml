- defaults:
    link:
      create: true
      relink: true

# library depends
- package:
  - git
  - curl
  - wget
  - linux: g++
  - make
  - python3
  - python
  - linux: libssl-dev

- shell:
  - [mkdir -p ~/.config/kitty]
  # Install rust and cargo
  - [curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs -o /tmp/rustup-init.sh]
  - [sh /tmp/rustup-init.sh -y]

- cargo:
  - bat
  - ripgrep
  - cargo-edit:
      features: vendored-openssl
  - skim
  - fd-find
  - exa
  - zoxide

- git:
  - url: 'https://github.com/rust-analyzer/rust-analyzer.git'
    path: '{HOME}/.local/rust-analyzer'
    post:
      - cargo xtask install --server

- self_build:
  # llvm
  - vars:
      platform:
        linux: linux-gnu-ubuntu-16.04
        darwin: apple-darwin
      version: 12.0.0
    url: https://github.com/llvm/llvm-project/releases/download/llvmorg-12.0.0/clang+llvm-{version}-x86_64-{platform}.tar.xz
    format: tar.xz
    install:
      - ['mkdir', '-p', '{HOME}/.local/llvm/{version}/']
      - ['cp', '-r', 'clang+llvm-{version}-x86_64-{platform}', '{HOME}/.local/llvm/{version}/']
    export:
      DOTFILES_LLVM_PATH: '{HOME}/.local/llvm/{version}/clang+llvm-{version}-x86_64-{platform}'
  # cmake
  - vars:
      version: 3.20.1
    url: https://github.com/Kitware/CMake/releases/download/v{version}/cmake-{version}.tar.gz
    format: tar.gz
    install:
      - ['./configure']
      - ['make']
      - ['sudo', 'make', 'install']

# setup kitty
- link:
    ~/.config/kitty/kitty.conf: dots/kitty/kitty.conf
    ~/.config/kitty/kitty_theme.conf: dots/kitty/melange_dark.conf

# - link:
#     ~/.dotvim: dotvim
#     ~/.config/nvim/init.lua:
#       create: true

- clean: ['~']

